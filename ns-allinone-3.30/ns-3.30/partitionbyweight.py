import numpy as np
from sklearn.cluster import AgglomerativeClustering
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap
import time
start_time = time.time()

x = np.arange(-47, 48, 2) 
y = np.arange(63, -64, -2) 
print (x)
print (y)
X = np.transpose([np.tile(x, len(y)), np.repeat(y, len(x))])

weights = np.array([
100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.9,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.9,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.9,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,100,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.9,0.3,0.3,0.3,0.3,0.3,0.9,0.3,0.3,0.3,0.3,0.3,100,100,100,100,100,100,100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
100,100,100,100,100,100,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9,0.1,0.1,0.1,0.1,0.1,0.9])
print (len(weights))
def weighted_distance(x1, x2, w1, w2):
    return w1 * w2 * np.linalg.norm(x1 - x2)

dist_matrix = np.zeros((X.shape[0], X.shape[0]))
for i in range(X.shape[0]):
    for j in range(X.shape[0]):
        dist_matrix[i,j] = weighted_distance(X[i], X[j], weights[i], weights[j])

cluster = AgglomerativeClustering(n_clusters=12, linkage='average').fit(dist_matrix)
labels = cluster.labels_

colors = ['#1B9E77', '#D95F02', '#7570B3', '#E7298A', '#66A61E', '#E6AB02']
cmap = ListedColormap(colors)



plt.scatter(X[:, 0], X[:, 1], c=labels, cmap=cmap)
plt.xlabel('X')
plt.ylabel('Y')
plt.title('Agglomerative Clustering')
end_time = time.time()


runtime = end_time - start_time


print("runtume:", runtime, "s")
plt.show()

